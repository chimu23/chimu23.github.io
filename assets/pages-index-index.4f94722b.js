import{o as e,f as t,g as l,n as a,r as o,p as i,e as s,w as n,t as d,c as u,q as c,u as m,v as r,x as p,F as v,y as h,z as f,A as b,k as g,l as x}from"../vendor.88604502.js";import{_ as w}from"./index.e3b3c33c.js";import{h as k,_ as y}from"../index.d84e2dbb.js";import{_ as I,a as V}from"../index.d6bae7cd.js";var _=w({props:{modelValue:{type:Boolean,default:!1}},setup:i=>(s,n)=>(e(),t("div",{class:"inline-block cursor-pointer mt-0.5"},[l("div",{class:a([" inline-block w-4 h-4 md:w-3.5 md:h-3.5 mx-2 rounded border relative",i.modelValue?"border-indigo-400":"border-indigo-300"]),onClick:n[0]||(n[0]=e=>(s.$emit("update:modelValue",!i.modelValue),s.$emit("change",!i.modelValue)))},[l("div",{class:a(["absolute w-2 h-2 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 transform transition-all delay-100 bg-indigo-300 rounded-sm",[i.modelValue?"opacity-100":"opacity-0"]])},null,2),l("div",{class:a(["pointer-events-none absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 transform transition-all bg-indigo-300 rounded-full",{"animate-shadow":i.modelValue}])},null,2)],2),l("span",{class:"inline-block transform -translate-y-0.5"},[o(s.$slots,"default",{},void 0,!0)])]))},[["__scopeId","data-v-1d11cde5"]]);const S={props:["item","index"],emits:["editItem","deleteItem"],setup(o,{emit:m}){const r=o;return(m,p)=>{const v=i("svgIcon");return e(),t("div",{class:"flex justify-between items-center w-full text-base group bg-white rounded py-1.5 pl-2 pr-3"},[s(_,{modelValue:o.item.checked,onChange:p[0]||(p[0]=e=>m.$emit("delete-item",o.index))},{default:n((()=>[l("span",{class:a({" line-through italic text-gray-200 cursor-not-allowed":o.item.checked})},d(o.item.title),3)])),_:1},8,["modelValue"]),o.item.checked?c("",!0):(e(),u(v,{key:0,icon:"icon-bianji",class:"w-4 h-4 group-hover:text-theme cursor-pointer",onClick:p[1]||(p[1]=e=>m.$emit("editItem",r.item))}))])}}};const T={props:{isShow:{type:Boolean,default:!1},item:{type:Object,default:{title:"",note:""}}},emits:["addItem","updateItem"],setup(t,{emit:a}){const o=t,i=m(o.item.title),d=m(o.item.note);function r(){const{_id:e}=o.item;(function(e,t,l){return k("todolist",{method:"put",_id:e,title:t,note:l})})(e,i.value,d.value).then((()=>{a("updateItem",{title:i.value,note:d.value,checked:!1}),a("update:isShow",!1)}))}return(a,o)=>t.isShow?(e(),u(y,{key:0,width:"20rem",title:"修改下内容~",isShow:t.isShow,"onUpdate:isShow":o[2]||(o[2]=e=>a.$emit("update:isShow",e)),onConfirm:r},{default:n((()=>[l("div",{class:"text-sm flex justify-around items-center px-5 mb-3"},[l("span",{class:"mr-3"},"标题:"),s(I,{class:"flex-1",modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=e=>i.value=e)},null,8,["modelValue"])]),l("div",{class:"text-sm flex items-center px-5"},[l("span",{class:"mr-3"},"内容:"),s(I,{class:"flex-1",placeholder:"描述更多细节",modelValue:d.value,"onUpdate:modelValue":o[1]||(o[1]=e=>d.value=e)},null,8,["modelValue"])])])),_:1},8,["isShow"])):c("",!0)}},j={props:["item","tabInfo","isLoading","todoTotal"],emits:["update:isLoading","update:todoTotal"],setup(o,{emit:n}){const d=o,g=m(!1),x=m(""),w=m(!1),y=r({item:{title:"",note:""},list:[]});let V=p((()=>{let e=[];switch(d.tabInfo){case"全部":e=y.list;break;case"已完成":e=y.list.filter((e=>!0===e.checked));break;case"未完成":e=y.list.filter((e=>!1===e.checked))}return n("update:todoTotal",e.length),e}));function _(){const{value:e}=x;if(!e.trim())return b({title:"不能为空",icon:"none"});w.value=!0,function({title:e,note:t}){return k("todolist",{method:"add",title:e})}({title:e}).then((({id:e})=>{y.list.push({_id:e,title:x.value,checked:!1}),x.value="",w.value=!1,n("update:todoTotal",d.todoTotal+1)}))}function j(e){const t=y.list[e];var l;t.checked=!0,(l=t._id,k("todolist",{method:"delete",_id:l})).catch((()=>{t.checked=!1}))}function U(e){const{_id:t}=y.item,l=y.list.findIndex((e=>e._id===t));y.list[l]=e}return k("todolist").then((({data:e,count:t})=>{y.list=e,n("update:isLoading",!1),n("update:todoTotal",t)})),(o,n)=>{const d=i("svgIcon");return e(),t(v,null,[l("div",{class:"flex items-center mb-3"},[s(I,{modelValue:x.value,"onUpdate:modelValue":n[0]||(n[0]=e=>x.value=e),class:"flex-1"},null,8,["modelValue"]),s(d,{class:a(["w-7 h-7 ml-3",{"animate-pulse":w.value}]),icon:"icon-fasong",onClick:_},null,8,["class"])]),l("div",{"data-desc":"todo列表",class:"space-y-2"},[(e(!0),t(v,null,h(f(V),((t,l)=>(e(),u(S,{key:l,item:t,index:l,onDeleteItem:j,onEditItem:e=>(f(y).item=e,g.value=!0)},null,8,["item","index","onEditItem"])))),128))]),g.value?(e(),u(T,{key:0,ref:(e,t)=>{t.todoDialogRef=e},isShow:g.value,"onUpdate:isShow":n[1]||(n[1]=e=>g.value=e),item:f(y).item,onAddItem:n[2]||(n[2]=e=>f(y).list.push(e)),onUpdateItem:U},null,8,["isShow","item"])):c("",!0)],64)}}},U={props:{num:{type:String,default:0}},setup:a=>(i,s)=>(e(),t("div",{class:"relative"},[o(i.$slots,"default",{},(()=>[g("数字")])),l("div",{class:"w-4 h-4 leading-4 text-center absolute -top-2 -right-2 text-xxs text-white bg-indigo-200 rounded-full"},d(a.num),1)]))},C={setup(o){m(null);const d=m(!1),c=m(!1),r=m(!0),p=m(0),v=m(["全部","已完成","未完成"]),h=m(v.value[0]);function f(e){h.value=v.value[e]}return(o,m)=>{const b=i("svgIcon");return e(),t("div",{class:"w-11/12 p-3 mt-2 mx-auto shadow-md rounded-md bg-indigo-50"},[l("div",{class:"flex justify-between border-b-2 border-white pb-1 mb-2"},[l("span",{class:"text-lg font-bold"},"List"),s(U,{num:p.value,onClick:m[0]||(m[0]=e=>{c.value||(c.value=!0,setTimeout((()=>{c.value=!1}),2500))}),class:a({"animate-bounce":c.value})},{default:n((()=>[r.value?(e(),u(b,{key:0,icon:"icon-dengdai",class:"w-5 h-5 cursor-pointer animate-spin"})):(e(),u(b,{key:1,icon:"icon-xiangsu_tuzi",class:"w-5 h-5"}))])),_:1},8,["num","class"])]),s(V,{onChange:f,class:"mb-2",list:v.value},null,8,["list"]),s(j,{todoTotal:p.value,"onUpdate:todoTotal":m[1]||(m[1]=e=>p.value=e),isLoading:r.value,"onUpdate:isLoading":m[2]||(m[2]=e=>r.value=e),onEditItem:m[3]||(m[3]=e=>d.value=!0),"tab-info":h.value},null,8,["todoTotal","isLoading","tab-info"])])}}};x(C);export{C as default};
